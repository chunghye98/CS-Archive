# 뮤텍스와 세마포어란?
> 프로세스 동기화를 위한 도구인 뮤텍스 락, 세마포어에 대해 알아보자

## 뮤텍스 락 Mutex lock
동시에 접근해서는 안 되는 자원에 동시에 접근하지 않도록 만드는 도구, 상호 배제를 위한 동기화 도구이다.

임계 구역에 진입하는 프로세스는 **내가 임계 구역에 있음**을 알리기 위해 lock을 사용해 잠근다.
다른 프로세스는 임계 구역이 잠겨 있다면 기다리고, 잠겨 있지 않다면 임계 구역에 진입할 수 있다.

### 뮤텍스 락의 구현
- 자물쇠 역할: 프로세스들이 공유하는 전역 변수 `lock`
- 임계 구역을 잠그는 역할 : `acquire 함수`
- 임계 구역 잠금을 해제하는 역할 : `release 함수`

```
acquire() {
    while (lock == true) /* 임계 구역이 잠겨 있다면 */
        ;                /* 임계 구역이 잠겨 있는지를 반복적으로 확인 */
    lock = true;         /* 만약 임계 구역이 잠겨 있지 않다면 임계 구역 잠금 */
}

release() {
    lock = false;        /* 임계 구역 작업이 끝났으니 잠금 해제 */	
}
```

acquire 함수와 release 함수를 임계 구역 전후로 호출함으로써 하나의 프로세스만 임계 구역에 진입할 수 있다.
```
acquire(); // 자물쇠가 걸려 있는지 확인, 잠겨있지 않다면 잠그고 들어가기
// 임계 구역
release(); // 자물쇠 반환
```

이렇게 반복적으로 임계 구역이 잠겨있지 않은지 확인하며 대기하는 방식을 **바쁜 대기(busy wait)**라고 한다.

## 세마포어 Semaphore
공유 자원이 여러 개 있는 상황에서도 적용이 가능한 동기화 도구이다. 

프로세스는 임계 구역 앞에서 멈춤 신호를 받으면 잠시 기다리고, 가도 좋다는 신호를 받으면 그제서야 임계 구역에 들어가게 된다.

### 세마포어의 구현
- 임계 구역에 진입할 수 있는 프로세스의 개수: `전역 변수 S`
- 임계 구역에 들어가도 좋은지, 기다려야 할지 알려주는 역할: `wait 함수`
- 임계 구역 앞에서 기다리는 프로세스에 가도 좋다고 신호를 주는 역할: `signal 함수`

```
wait() {
     while ( S <= 0 )    /* 임계 구역에 진입할 수 있는 프로세스 개수가 0개 이하라면 */
        ;                /* 사용할 수 있는 자원이 있는지 반복적으로 확인 */
     S--;                /* 임계 구역에 진입할 수 있으면 S를 1 감소하고 진입한다 */
}
```

```
signal() {
    S++;                 /* 임계 구역에서의 작업을 마친 뒤 S를 1 증가시킨다 */
}
```

임계구역 전후로 wait()와 signal()을 호출하여 임계 구역에 접근한다.
```
wait();
// 임계 구역
signal();
```



## 참고
혼자 공부하는 컴퓨터구조 + 운영체제  
